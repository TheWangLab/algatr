<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>K selection — select_K • algatr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="K selection — select_K"><meta name="description" content="K selection"><meta property="og:description" content="K selection"><meta property="og:image" content="https://thewanglab.github.io/algatr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">algatr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference Manual</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/data_processing_vignette.html">Genetic data processing</a></li>
    <li><a class="dropdown-item" href="../articles/enviro_data_vignette.html">Environmental data processing</a></li>
    <li><a class="dropdown-item" href="../articles/masking_vignette.html">Masking</a></li>
    <li><a class="dropdown-item" href="../articles/gen_dist_vignette.html">Genetic distances</a></li>
    <li><a class="dropdown-item" href="../articles/TESS_vignette.html">TESS</a></li>
    <li><a class="dropdown-item" href="../articles/MMRR_vignette.html">MMRR</a></li>
    <li><a class="dropdown-item" href="../articles/GDM_vignette.html">GDM</a></li>
    <li><a class="dropdown-item" href="../articles/RDA_vignette.html">RDA</a></li>
    <li><a class="dropdown-item" href="../articles/LFMM_vignette.html">LFMM</a></li>
    <li><a class="dropdown-item" href="../articles/wingen_vignette.html">Wingen</a></li>
    <li><a class="dropdown-item" href="../articles/alazygatr_vignette.html">Alazygatr</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>K selection</h1>

      <div class="d-none name"><code>select_K.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>K selection</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">select_K</span><span class="op">(</span></span>
<span>  <span class="va">gen</span>,</span>
<span>  K_selection <span class="op">=</span> <span class="st">"tracy_widom"</span>,</span>
<span>  coords <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Kvals <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  criticalpoint <span class="op">=</span> <span class="fl">2.023</span>,</span>
<span>  low <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>  max.pc <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  perc.pca <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  max.n.clust <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">select_K_tw</span><span class="op">(</span><span class="va">gen</span>, criticalpoint <span class="op">=</span> <span class="fl">2.0234</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">select_K_elbow</span><span class="op">(</span><span class="va">gen</span>, low <span class="op">=</span> <span class="fl">0.08</span>, max.pc <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">select_K_tess</span><span class="op">(</span></span>
<span>  <span class="va">gen</span>,</span>
<span>  <span class="va">coords</span>,</span>
<span>  Kvals <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  tess_method <span class="op">=</span> <span class="st">"projected.ls"</span>,</span>
<span>  ploidy <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">select_K_fc</span><span class="op">(</span><span class="va">gen</span>, <span class="va">perc.pca</span>, <span class="va">max.n.clust</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-gen">gen<a class="anchor" aria-label="anchor" href="#arg-gen"></a></dt>
<dd><p>a genotype matrix</p></dd>


<dt id="arg-k-selection">K_selection<a class="anchor" aria-label="anchor" href="#arg-k-selection"></a></dt>
<dd><p>method for performing K selection (options: "tracy_widom" (default), "quick_elbow", or "tess")</p></dd>


<dt id="arg-coords">coords<a class="anchor" aria-label="anchor" href="#arg-coords"></a></dt>
<dd><p>coordinates for "tess"</p></dd>


<dt id="arg-kvals">Kvals<a class="anchor" aria-label="anchor" href="#arg-kvals"></a></dt>
<dd><p>values of K to test for "tess"</p></dd>


<dt id="arg-criticalpoint">criticalpoint<a class="anchor" aria-label="anchor" href="#arg-criticalpoint"></a></dt>
<dd><p>if <code>K_selection = "tracy_widom"</code>, a numeric value corresponding to the significance level. If the significance level is 0.05, 0.01, 0.005, or 0.001, the criticalpoint should be set to be 0.9793, 2.0234, 2.4224, or 3.2724, respectively (defaults to 2.0234)</p></dd>


<dt id="arg-low">low<a class="anchor" aria-label="anchor" href="#arg-low"></a></dt>
<dd><p>if <code>K_selection = "quick_elbow"</code>, numeric, between zero and one, the threshold that defines whether a principal component explains 'much' of the variance (defaults to 0.08).</p></dd>


<dt id="arg-max-pc">max.pc<a class="anchor" aria-label="anchor" href="#arg-max-pc"></a></dt>
<dd><p>if <code>K_selection = "quick_elbow"</code>, maximum percentage of the variance to capture before the elbow (cumulative sum to PC 'n'; defaults to 0.90).</p></dd>


<dt id="arg-perc-pca">perc.pca<a class="anchor" aria-label="anchor" href="#arg-perc-pca"></a></dt>
<dd><p>if <code>K_selection = "find_clusters"</code>, a numeric value between 0 and 100 indicating the minimal percentage of the total variance of the data to be expressed by the retained axes of PCA (defaults to 90).</p></dd>


<dt id="arg-max-n-clust">max.n.clust<a class="anchor" aria-label="anchor" href="#arg-max-n-clust"></a></dt>
<dd><p>if <code>K_selection = "find_clusters"</code>, an integer indicating the maximum number of clusters to try. Values of 'k' will be picked up between 1 and max.n.clust (defaults to 10)</p></dd>


<dt id="arg-tess-method">tess_method<a class="anchor" aria-label="anchor" href="#arg-tess-method"></a></dt>
<dd><p>method to use for "tess"</p></dd>


<dt id="arg-ploidy">ploidy<a class="anchor" aria-label="anchor" href="#arg-ploidy"></a></dt>
<dd><p>ploidy for "tess"</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>prints the best K value given the specified K selection procedure</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>

<ul><li><p><code>select_K_tw()</code>: select K using Tracy-Widom Test</p></li>
<li><p><code>select_K_elbow()</code>: select K using PCA and <code>quick_elbow</code> method</p></li>
<li><p><code>select_K_tess()</code>: select K using TESS and <code>bestK</code> method</p></li>
<li><p><code>select_K_fc()</code>: select K using find.clusters method</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>uses the <a href="https://rdrr.io/pkg/AssocTests/man/tw.html" class="external-link">tw</a> function</p>
<p>uses the <a href="https://rdrr.io/pkg/adegenet/man/find.clusters.html" class="external-link">find.clusters</a> function</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other LFMM functions:
<code><a href="lfmm_df.html">lfmm_df</a>()</code>,
<code><a href="lfmm_do_everything.html">lfmm_do_everything</a>()</code>,
<code><a href="lfmm_manhattanplot.html">lfmm_manhattanplot</a>()</code>,
<code><a href="lfmm_qqplot.html">lfmm_qqplot</a>()</code>,
<code><a href="lfmm_run.html">lfmm_run</a>()</code>,
<code><a href="lfmm_table.html">lfmm_table</a>()</code>,
<code><a href="lfmm_test_tidy.html">lfmm_test_tidy</a>()</code>,
<code><a href="quick_elbow.html">quick_elbow</a>()</code></p>
<p>Other LFMM functions:
<code><a href="lfmm_df.html">lfmm_df</a>()</code>,
<code><a href="lfmm_do_everything.html">lfmm_do_everything</a>()</code>,
<code><a href="lfmm_manhattanplot.html">lfmm_manhattanplot</a>()</code>,
<code><a href="lfmm_qqplot.html">lfmm_qqplot</a>()</code>,
<code><a href="lfmm_run.html">lfmm_run</a>()</code>,
<code><a href="lfmm_table.html">lfmm_table</a>()</code>,
<code><a href="lfmm_test_tidy.html">lfmm_test_tidy</a>()</code>,
<code><a href="quick_elbow.html">quick_elbow</a>()</code></p>
<p>Other LFMM functions:
<code><a href="lfmm_df.html">lfmm_df</a>()</code>,
<code><a href="lfmm_do_everything.html">lfmm_do_everything</a>()</code>,
<code><a href="lfmm_manhattanplot.html">lfmm_manhattanplot</a>()</code>,
<code><a href="lfmm_qqplot.html">lfmm_qqplot</a>()</code>,
<code><a href="lfmm_run.html">lfmm_run</a>()</code>,
<code><a href="lfmm_table.html">lfmm_table</a>()</code>,
<code><a href="lfmm_test_tidy.html">lfmm_test_tidy</a>()</code>,
<code><a href="quick_elbow.html">quick_elbow</a>()</code></p>
<p>Other LFMM functions:
<code><a href="lfmm_df.html">lfmm_df</a>()</code>,
<code><a href="lfmm_do_everything.html">lfmm_do_everything</a>()</code>,
<code><a href="lfmm_manhattanplot.html">lfmm_manhattanplot</a>()</code>,
<code><a href="lfmm_qqplot.html">lfmm_qqplot</a>()</code>,
<code><a href="lfmm_run.html">lfmm_run</a>()</code>,
<code><a href="lfmm_table.html">lfmm_table</a>()</code>,
<code><a href="lfmm_test_tidy.html">lfmm_test_tidy</a>()</code>,
<code><a href="quick_elbow.html">quick_elbow</a>()</code></p>
<p>Other LFMM functions:
<code><a href="lfmm_df.html">lfmm_df</a>()</code>,
<code><a href="lfmm_do_everything.html">lfmm_do_everything</a>()</code>,
<code><a href="lfmm_manhattanplot.html">lfmm_manhattanplot</a>()</code>,
<code><a href="lfmm_qqplot.html">lfmm_qqplot</a>()</code>,
<code><a href="lfmm_run.html">lfmm_run</a>()</code>,
<code><a href="lfmm_table.html">lfmm_table</a>()</code>,
<code><a href="lfmm_test_tidy.html">lfmm_test_tidy</a>()</code>,
<code><a href="quick_elbow.html">quick_elbow</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anusha Bishop, Anne Chambers, Ian Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

