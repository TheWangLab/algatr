<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="LFMM function to do everything"><title>LFMM function to do everything — lfmm_do_everything • algatr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="LFMM function to do everything — lfmm_do_everything"><meta property="og:description" content="LFMM function to do everything"><meta property="og:image" content="https://thewanglab.github.io/algatr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">algatr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_processing_vignette.html">Genetic data processing</a>
    <a class="dropdown-item" href="../articles/enviro_data_vignette.html">Environmental data processing</a>
    <a class="dropdown-item" href="../articles/Masking_vignette.html">Masking</a>
    <a class="dropdown-item" href="../articles/gen_dist_vignette.html">Genetic distances</a>
    <a class="dropdown-item" href="../articles/TESS_vignette.html">TESS</a>
    <a class="dropdown-item" href="../articles/MMRR_vignette.html">MMRR</a>
    <a class="dropdown-item" href="../articles/GDM_vignette.html">GDM</a>
    <a class="dropdown-item" href="../articles/RDA_vignette.html">RDA</a>
    <a class="dropdown-item" href="../articles/LFMM_vignette.html">LFMM</a>
    <a class="dropdown-item" href="../articles/wingen_vignette.html">Wingen</a>
    <a class="dropdown-item" href="../articles/alazygatr_vignette.html">Alazygatr</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>LFMM function to do everything</h1>
      
      <div class="d-none name"><code>lfmm_do_everything.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>LFMM function to do everything</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lfmm_do_everything</span><span class="op">(</span></span>
<span>  <span class="va">gen</span>,</span>
<span>  <span class="va">env</span>,</span>
<span>  coords <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  impute <span class="op">=</span> <span class="st">"structure"</span>,</span>
<span>  K_impute <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  entropy <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  repetitions <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  project <span class="op">=</span> <span class="st">"new"</span>,</span>
<span>  quiet_impute <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  save_output <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  output_filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  K <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lfmm_method <span class="op">=</span> <span class="st">"ridge"</span>,</span>
<span>  K_selection <span class="op">=</span> <span class="st">"tracy_widom"</span>,</span>
<span>  Kvals <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  sig <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  p_adj <span class="op">=</span> <span class="st">"fdr"</span>,</span>
<span>  calibrate <span class="op">=</span> <span class="st">"gif"</span>,</span>
<span>  criticalpoint <span class="op">=</span> <span class="fl">2.0234</span>,</span>
<span>  low <span class="op">=</span> <span class="fl">0.08</span>,</span>
<span>  max.pc <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  perc.pca <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  max.n.clust <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>gen</dt>
<dd><p>genotype dosage matrix (rows = individuals &amp; columns = SNPs) or <code>vcfR</code> object</p></dd>


<dt>env</dt>
<dd><p>dataframe with environmental data or a Raster* type object from which environmental values for the coordinates can be extracted</p></dd>


<dt>coords</dt>
<dd><p>dataframe with coordinates (only needed if K selection is performed with TESS or if environmental values are not provided)</p></dd>


<dt>impute</dt>
<dd><p>if NAs in <code>gen</code>, imputation will be performed on missing values; options are "structure" which uses the <code><a href="str_impute.html">str_impute()</a></code> function to impute based on population structure inferred with <code><a href="https://rdrr.io/pkg/LEA/man/main_sNMF.html" class="external-link">LEA::snmf</a></code> (default); other option is "simple" based on <code><a href="simple_impute.html">simple_impute()</a></code> which imputes to the median</p></dd>


<dt>K_impute</dt>
<dd><p>if <code>impute = "structure"</code>, an integer vector (range or single value) corresponding to the number of ancestral populations for which the sNMF algorithm estimates have to be calculated (defaults to 3)</p></dd>


<dt>entropy</dt>
<dd><p>A boolean value. If true, the cross-entropy criterion is calculated 
    (see <code><a href="https://rdrr.io/pkg/LEA/man/main_createDataSet.html" class="external-link">create.dataset</a></code> and 
    <code><a href="https://rdrr.io/pkg/LEA/man/main_crossEntropyEstimation.html" class="external-link">cross.entropy.estimation</a></code>).</p></dd>


<dt>repetitions</dt>
<dd><p>An integer corresponding with the number of repetitions for each value of 
    <code>K</code>.</p></dd>


<dt>project</dt>
<dd><p>A character string among "continue", "new", and "force". If "continue",
    the results are stored in the current project. If "new", the current 
    project is removed and a new one is created to store the result. If 
    "force", the results are stored in the current project even if the input 
    file has been modified since the creation of the project.</p></dd>


<dt>quiet_impute</dt>
<dd><p>if <code>impute = "structure"</code>, whether to print results of cross-entropy scores (defaults to TRUE; only does so if K is range of values); only displays run with minimum cross-entropy</p></dd>


<dt>save_output</dt>
<dd><p>if <code>impute = "structure"</code>, if TRUE, saves SNP GDS and ped (plink) files with retained SNPs in new directory; if FALSE returns object (defaults to FALSE)</p></dd>


<dt>output_filename</dt>
<dd><p>if <code>impute = "structure"</code> and <code>save_output = TRUE</code>, name prefix for saved .geno file, SNMF project file, and SNMF output file results (defaults to FALSE, in which no files are saved)</p></dd>


<dt>K</dt>
<dd><p>number of latent factors (if left as NULL (default), K value selection will be conducted)</p></dd>


<dt>lfmm_method</dt>
<dd><p>lfmm method (either <code>"ridge"</code> (default) or <code>"lasso"</code>)</p></dd>


<dt>K_selection</dt>
<dd><p>method for performing k selection (can either by "tracy_widom" (default), "quick_elbow", "tess", or "find_clusters")</p></dd>


<dt>Kvals</dt>
<dd><p>values of K to test for "tess"</p></dd>


<dt>sig</dt>
<dd><p>alpha level for determining candidate SNPs (defaults to 0.05)</p></dd>


<dt>p_adj</dt>
<dd><p>method to use for p-value correction (defaults to "fdr"); other options can be found in <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code></p></dd>


<dt>calibrate</dt>
<dd><p>a character string, "gif" or "median+MAD". If the "gif" option is set (default),
significance values are calibrated by using the genomic control method. Genomic control
uses a robust estimate of the variance of z-scores called "genomic inflation factor".
If the "median+MAD" option is set, the pvalues are calibrated by computing the median and MAD of the zscores. If <code>NULL</code>, the
pvalues are not calibrated.</p></dd>


<dt>criticalpoint</dt>
<dd><p>if <code>K_selection = "tracy_widom"</code>, a numeric value corresponding to the significance level. If the significance level is 0.05, 0.01, 0.005, or 0.001, the criticalpoint should be set to be 0.9793, 2.0234, 2.4224, or 3.2724, respectively (defaults to 2.0234)</p></dd>


<dt>low</dt>
<dd><p>if <code>K_selection = "quick_elbow"</code>, numeric, between zero and one, the threshold that defines whether a principal component explains 'much' of the variance (defaults to 0.08).</p></dd>


<dt>max.pc</dt>
<dd><p>if <code>K_selection = "quick_elbow"</code>, maximum percentage of the variance to capture before the elbow (cumulative sum to PC 'n'; defaults to 0.90).</p></dd>


<dt>perc.pca</dt>
<dd><p>if <code>K_selection = "find_clusters"</code>, a numeric value between 0 and 100 indicating the minimal percentage of the total variance of the data to be expressed by the retained axes of PCA (defaults to 90).</p></dd>


<dt>max.n.clust</dt>
<dd><p>if <code>K_selection = "find_clusters"</code>, an integer indicating the maximum number of clusters to try. Values of 'k' will be picked up between 1 and max.n.clust (defaults to 10)</p></dd>


<dt>quiet</dt>
<dd><p>whether to print output tables and figures (defaults to FALSE)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>list with candidate SNPs, model results, and K-value</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>LFMM is run using the lfmm package: Jumentier, B. (2021). lfmm: Latent Factor Mixed Models. R package version 1.1.
See also: Caye, K., Jumentier, B., Lepeule, J., &amp; François, O. (2019). LFMM 2: Fast and accurate inference of gene-environment associations in genome-wide studies. Mol. Biol. Evol. 36(4):852-860. doi: https://doi.org/10.1093/molbev/msz008</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other LFMM functions: 
<code><a href="lfmm_df.html">lfmm_df</a>()</code>,
<code><a href="lfmm_manhattanplot.html">lfmm_manhattanplot</a>()</code>,
<code><a href="lfmm_qqplot.html">lfmm_qqplot</a>()</code>,
<code><a href="lfmm_run.html">lfmm_run</a>()</code>,
<code><a href="lfmm_table.html">lfmm_table</a>()</code>,
<code><a href="lfmm_test_tidy.html">lfmm_test_tidy</a>()</code>,
<code><a href="quick_elbow.html">quick_elbow</a>()</code>,
<code><a href="select_K.html">select_K</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Anusha Bishop, Anne Chambers, Ian Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

