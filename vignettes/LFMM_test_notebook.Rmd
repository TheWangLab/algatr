---
title: "LFMM"
output: html_document
---

# Setup
```{r, warning = FALSE, message = FALSE}
library("algatr")
library("here")
#to install LFMM:
#devtools::install_github("bcm-uga/lfmm")
library("lfmm") 
library("tidyverse")

#libraries for k seleciton
library("AssocTests")
library("tess3r")

devtools::load_all()
```

### Load Test Data

```{r, warning = FALSE}
load_example()
gen <- vcf_to_dosage(liz_vcf)
```

# Run LFMM

## Comparing different LFMM methods

```{r, warning = FALSE,  results = FALSE, message = FALSE, warning = FALSE, fig.height=4, fig.width = 6}
results <- lfmm_do_everything(gen, env, lfmm_method = "ridge", K_selection = "tracy.widom")
```


## Comparing different K selection methods

```{r, warning = FALSE,  results=FALSE, warning = FALSE}
results_tw <- lfmm_do_everything(gen, env, K_selection = "tracy.widom")
```

```{r, results = FALSE, warning = FALSE}
results_qe <- lfmm_do_everything(gen, env = env, K_selection = "quick.elbow")
```

```{r, results = FALSE, cache = TRUE, warning = FALSE}
results_tess <- lfmm_do_everything(gen, env, coords, K_selection = "tess", Kvals = 1:20)
```



