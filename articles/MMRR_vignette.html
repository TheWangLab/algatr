<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>MMRR • algatr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MMRR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">algatr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference Manual</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/data_processing_vignette.html">Genetic data processing</a></li>
    <li><a class="dropdown-item" href="../articles/enviro_data_vignette.html">Environmental data processing</a></li>
    <li><a class="dropdown-item" href="../articles/masking_vignette.html">Masking</a></li>
    <li><a class="dropdown-item" href="../articles/gen_dist_vignette.html">Genetic distances</a></li>
    <li><a class="dropdown-item" href="../articles/TESS_vignette.html">TESS</a></li>
    <li><a class="dropdown-item" href="../articles/MMRR_vignette.html">MMRR</a></li>
    <li><a class="dropdown-item" href="../articles/GDM_vignette.html">GDM</a></li>
    <li><a class="dropdown-item" href="../articles/RDA_vignette.html">RDA</a></li>
    <li><a class="dropdown-item" href="../articles/LFMM_vignette.html">LFMM</a></li>
    <li><a class="dropdown-item" href="../articles/wingen_vignette.html">Wingen</a></li>
    <li><a class="dropdown-item" href="../articles/alazygatr_vignette.html">Alazygatr</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>MMRR</h1>
            
      

      <div class="d-none name"><code>MMRR_vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="multiple-matrix-regression-with-randomization-mmrr">Multiple matrix regression with randomization (MMRR)<a class="anchor" aria-label="anchor" href="#multiple-matrix-regression-with-randomization-mmrr"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://thewanglab.github.io/algatr/">algatr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install required packages</span></span>
<span><span class="fu"><a href="../reference/mmrr_packages.html">mmrr_packages</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>If using MMRR, please cite the following: Wang I.J. (2013)
Examining the full effects of landscape heterogeneity on spatial genetic
variation: a multiple matrix regression approach for quantifying
geographic and ecological isolation. Evolution 67(1):3403-3411. <a href="DOI:10.1111/evo.12134" class="uri">DOI:10.1111/evo.12134</a></strong></p>
<p>Multiple matrix regression with randomization (<a href="https://onlinelibrary.wiley.com/doi/full/10.1111/evo.12134" class="external-link">Wang
2013</a>) examines how heterogeneity in the landscape (both geographic
and environmental) affects spatial genetic variation, allowing a user to
determine the relative contributions of isolation by distance (i.e., an
association between genetic and geographic distances) and isolation by
environment (i.e., an association between genetic and environmental
distances). MMRR can provide information concerning how dependent
variables (in our case, genetic data) change with respect to multiple
independent variables (environmental and geographic distances).</p>
<p>The randomization aspect of MMRR is that significance testing is
performed through random permutations of the rows and columns of the
dependent matrix (the genetic distances), which is necessary because of
the non-independence of values in pairwise distance matrices. Once
significance testing is completed, MMRR provides individual regression
coefficients and p-values for each dependent variable and a “coefficient
ratio,” which is the ratio between regression coefficients, which thus
provides an idea of the relative contributions of IBD and IBE in
explaining variation in the genetic distances in your data.</p>
<p>There are a few assumptions built into this function that users
should be aware of: (1) the coordinates and genetic distance files MUST
have the same ordering of individuals; there isn’t a check for this, and
(2) this function assumes that each individual has its own sampling
coordinates (even if population-based sampling was performed).</p>
<div class="section level4">
<h4 id="read-in-and-process-genetic-data">Read in and process genetic data<a class="anchor" aria-label="anchor" href="#read-in-and-process-genetic-data"></a>
</h4>
<p>Let’s load the example dataset and extract environmental variables
based on our sampling coordinates. To perform MMRR, we need a genetic
distance matrix; please refer to the genetic distances vignette for
information on how to generate this in algatr using a vcf file.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/load_algatr_example.html">load_algatr_example</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co"><span style="color: #00BBBB; font-weight: bold;">#&gt; ---------------- example dataset ----------------</span></span></span>
<span><span class="co"><span style="color: #00BBBB; font-weight: bold;">#&gt; </span> </span></span>
<span><span class="co"><span style="color: #0000BB;">#&gt; Objects loaded:</span> </span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold;">#&gt; *liz_vcf*</span> <span style="color: #BBBB00;">vcfR object (1000 loci x 53 samples)</span> </span></span>
<span><span class="co"><span style="color: #BBBB00; font-weight: bold;">#&gt; *liz_gendist*</span> <span style="color: #BBBB00;">genetic distance matrix (Plink Distance)</span> </span></span>
<span><span class="co"><span style="color: #00BB00; font-weight: bold;">#&gt; *liz_coords*</span> <span style="color: #00BB00;">dataframe with x and y coordinates</span> </span></span>
<span><span class="co"><span style="color: #BB00BB; font-weight: bold;">#&gt; *CA_env*</span> <span style="color: #BB00BB;">RasterStack with example environmental layers</span> </span></span>
<span><span class="co"><span style="color: #00BBBB; font-weight: bold;">#&gt; </span></span></span>
<span><span class="co"><span style="color: #00BBBB; font-weight: bold;">#&gt; -------------------------------------------------</span></span></span>
<span><span class="co"><span style="color: #00BBBB; font-weight: bold;">#&gt; </span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">liz_gendist</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="process-environmental-data">Process environmental data<a class="anchor" aria-label="anchor" href="#process-environmental-data"></a>
</h4>
<p>Let’s calculate environmental distances with our extracted
environmental values using the <code><a href="../reference/env_dist.html">env_dist()</a></code> function, and add
on geographic distances to this matrix using the <code><a href="../reference/geo_dist.html">geo_dist()</a></code>
function. For more information on how these two functions work, please
refer to algatr’s environmental data processing vignette.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract values from our environmental raster (CA_env)</span></span>
<span><span class="va">env</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">CA_env</span>, <span class="va">liz_coords</span><span class="op">)</span></span>
<span><span class="co"># Calculate environmental distances</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/env_dist.html">env_dist</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span></span>
<span><span class="co"># Add geographic distance to X</span></span>
<span><span class="va">X</span><span class="op">[[</span><span class="st">"geodist"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geo_dist.html">geo_dist</a></span><span class="op">(</span><span class="va">liz_coords</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-mmrr">Run MMRR<a class="anchor" aria-label="anchor" href="#run-mmrr"></a>
</h3>
<hr>
<p>We can run MMRR using the <code><a href="../reference/mmrr_run.html">mmrr_run()</a></code> function. We can
either run the full model (with no variable selection) by setting
<code>model = "full"</code>, or by running a variable selection
procedure using backwards elimination by setting
<code>model = "best"</code> within this function. The arguments to
<code><a href="../reference/mmrr_run.html">mmrr_run()</a></code> are as follows:</p>
<ul>
<li><p><code>Y</code>: matrix of genetic distances</p></li>
<li><p><code>X</code>: matrix of environmental distances (including
geographic distances) at each sampling coordinate</p></li>
<li><p><code>nperm</code>: number of permutations to perform</p></li>
<li><p><code>stdz</code>: whether matrices are standardized</p></li>
</ul>
<div class="section level4">
<h4 id="mmrr-with-all-variables">MMRR with all variables<a class="anchor" aria-label="anchor" href="#mmrr-with-all-variables"></a>
</h4>
<p>First, let’s run the full MMRR model with all variables included
(i.e., no variable selection).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">results_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrr_run.html">mmrr_run</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, nperm <span class="op">=</span> <span class="fl">99</span>, stdz <span class="op">=</span> <span class="cn">TRUE</span>, model <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></span></code></pre></div>
<p>The results from running the “full” MMRR model contains four
elements:</p>
<ul>
<li><p><code>coeff_df</code>: a dataframe with statistics relating to
each variable’s distance related to genetic distance, including
coefficient values for each environmental variable and geographic
distance</p></li>
<li><p><code>mod</code>: a dataframe containing statistics for the
results of the model, including an R^2 value, and F statistics</p></li>
<li><p><code>X</code> and <code>Y</code>: the input data</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="mmrr-with-model-selection">MMRR with model selection<a class="anchor" aria-label="anchor" href="#mmrr-with-model-selection"></a>
</h4>
<p>Now, let’s run MMRR with variable selection.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run MMRR with all variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">01</span><span class="op">)</span></span>
<span><span class="va">results_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrr_run.html">mmrr_run</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, nperm <span class="op">=</span> <span class="fl">99</span>, stdz <span class="op">=</span> <span class="cn">TRUE</span>, model <span class="op">=</span> <span class="st">"best"</span><span class="op">)</span></span></code></pre></div>
<p>Once again, the results from running <code><a href="../reference/mmrr_run.html">mmrr_run()</a></code> with
model selection contains the same elements as “full”, except that the
“best” model result now also has an <code>X_best</code> element, which
contains values for significant variables; in this case, the only
significant variable found was geographic distance. You can also see
that the <code>coeff_df</code> element is reduced from all four
variables to only those variables that were significantly associated
with genetic distance (in the test example case, only geographic
distance).</p>
</div>
</div>
<div class="section level3">
<h3 id="visualizing-mmrr-results">Visualizing MMRR results<a class="anchor" aria-label="anchor" href="#visualizing-mmrr-results"></a>
</h3>
<hr>
<div class="section level4">
<h4 id="plotting-mmrr-results-with-mmrr_plot">Plotting MMRR results with <code>mmrr_plot()</code><a class="anchor" aria-label="anchor" href="#plotting-mmrr-results-with-mmrr_plot"></a>
</h4>
<p>Let’s take a look at the results from our MMRR analyses above. We can
produce several plots to visualize results with the
<code><a href="../reference/mmrr_plot.html">mmrr_plot()</a></code> function, including plotting single variable
relationships (<code>plot_type = "vars"</code>), plotting the fitted
relationship that compares predicted against the observed genetic
distances (<code>plot_type = "fitted"</code>), or plotting covariances
between the predictor variables (<code>plot_type = "cov"</code>).
Lastly, you can set <code>plot_type = "all"</code> to produce all three
of these plots for your MMRR run.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Single variable plot</span></span>
<span><span class="fu"><a href="../reference/mmrr_plot.html">mmrr_plot</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, mod <span class="op">=</span> <span class="va">results_full</span><span class="op">$</span><span class="va">mod</span>, plot_type <span class="op">=</span> <span class="st">"vars"</span>, stdz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MMRR_vignette_files/figure-html/mmrr%20plots-1.png" class="r-plt" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fitted variable plot</span></span>
<span><span class="fu"><a href="../reference/mmrr_plot.html">mmrr_plot</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, mod <span class="op">=</span> <span class="va">results_full</span><span class="op">$</span><span class="va">mod</span>, plot_type <span class="op">=</span> <span class="st">"fitted"</span>, stdz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MMRR_vignette_files/figure-html/fitted%20plot-1.png" class="r-plt" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Covariance plot</span></span>
<span><span class="fu"><a href="../reference/mmrr_plot.html">mmrr_plot</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, mod <span class="op">=</span> <span class="va">results_full</span><span class="op">$</span><span class="va">mod</span>, plot_type <span class="op">=</span> <span class="st">"cov"</span>, stdz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MMRR_vignette_files/figure-html/cov%20plot-1.png" class="r-plt" width="480" style="display: block; margin: auto;"></p>
<p>How do the above results compare to those from the “best” model?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mmrr_plot.html">mmrr_plot</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, mod <span class="op">=</span> <span class="va">results_best</span><span class="op">$</span><span class="va">mod</span>, plot_type <span class="op">=</span> <span class="st">"all"</span>, stdz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MMRR_vignette_files/figure-html/mmrr%20best%20plots-1.png" class="r-plt" width="480" style="display: block; margin: auto;"><img src="MMRR_vignette_files/figure-html/mmrr%20best%20plots-2.png" class="r-plt" width="480" style="display: block; margin: auto;"><img src="MMRR_vignette_files/figure-html/mmrr%20best%20plots-3.png" class="r-plt" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="look-at-mmrr-output-statistics-with-mmrr_table">Look at MMRR output statistics with <code>mmrr_table()</code><a class="anchor" aria-label="anchor" href="#look-at-mmrr-output-statistics-with-mmrr_table"></a>
</h4>
<p>We can also take a closer look at the output statistics from our MMRR
runs using the <code><a href="../reference/mmrr_table.html">mmrr_table()</a></code> function. This function will
also provide summary statistics if we set <code>summary_stats</code> to
TRUE (the default). The estimate column contains the coefficients for
each of the variables. <em>N.B.: significance values may change slightly
due to the permutation procedure.</em></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mmrr_table.html">mmrr_table</a></span><span class="op">(</span><span class="va">results_full</span>, digits <span class="op">=</span> <span class="fl">2</span>, summary_stats <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div id="wxgtfjptxi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wxgtfjptxi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wxgtfjptxi thead, #wxgtfjptxi tbody, #wxgtfjptxi tfoot, #wxgtfjptxi tr, #wxgtfjptxi td, #wxgtfjptxi th {
  border-style: none;
}

#wxgtfjptxi p {
  margin: 0;
  padding: 0;
}

#wxgtfjptxi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wxgtfjptxi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wxgtfjptxi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wxgtfjptxi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wxgtfjptxi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wxgtfjptxi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wxgtfjptxi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wxgtfjptxi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wxgtfjptxi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wxgtfjptxi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wxgtfjptxi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wxgtfjptxi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wxgtfjptxi .gt_spanner_row {
  border-bottom-style: hidden;
}

#wxgtfjptxi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wxgtfjptxi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wxgtfjptxi .gt_from_md > :first-child {
  margin-top: 0;
}

#wxgtfjptxi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wxgtfjptxi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wxgtfjptxi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wxgtfjptxi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wxgtfjptxi .gt_row_group_first td {
  border-top-width: 2px;
}

#wxgtfjptxi .gt_row_group_first th {
  border-top-width: 2px;
}

#wxgtfjptxi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wxgtfjptxi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wxgtfjptxi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wxgtfjptxi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wxgtfjptxi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wxgtfjptxi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wxgtfjptxi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wxgtfjptxi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wxgtfjptxi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wxgtfjptxi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wxgtfjptxi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wxgtfjptxi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wxgtfjptxi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wxgtfjptxi .gt_left {
  text-align: left;
}

#wxgtfjptxi .gt_center {
  text-align: center;
}

#wxgtfjptxi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wxgtfjptxi .gt_font_normal {
  font-weight: normal;
}

#wxgtfjptxi .gt_font_bold {
  font-weight: bold;
}

#wxgtfjptxi .gt_font_italic {
  font-style: italic;
}

#wxgtfjptxi .gt_super {
  font-size: 65%;
}

#wxgtfjptxi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wxgtfjptxi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wxgtfjptxi .gt_indent_1 {
  text-indent: 5px;
}

#wxgtfjptxi .gt_indent_2 {
  text-indent: 10px;
}

#wxgtfjptxi .gt_indent_3 {
  text-indent: 15px;
}

#wxgtfjptxi .gt_indent_4 {
  text-indent: 20px;
}

#wxgtfjptxi .gt_indent_5 {
  text-indent: 25px;
}

#wxgtfjptxi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wxgtfjptxi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="var">var</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p">p</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a95%-Lower">95% Lower</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a95%-Upper">95% Upper</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_empty_group_heading" scope="colgroup"></th>
    </tr>
<tr class="gt_row_group_first">
<td headers="model  var" class="gt_row gt_left">CA_rPCA1</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #F2EBF2; color: #000000;">−0.10</td>
<td headers="model  p" class="gt_row gt_right">0.06</td>
<td headers="model  95% Lower" class="gt_row gt_right">−0.14</td>
<td headers="model  95% Upper" class="gt_row gt_right">−0.07</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">CA_rPCA2</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #F6F7F6; color: #000000;">0.01</td>
<td headers="model  p" class="gt_row gt_right">0.77</td>
<td headers="model  95% Lower" class="gt_row gt_right">−0.03</td>
<td headers="model  95% Upper" class="gt_row gt_right">0.05</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">CA_rPCA3</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #F4F1F4; color: #000000;">−0.05</td>
<td headers="model  p" class="gt_row gt_right">0.36</td>
<td headers="model  95% Lower" class="gt_row gt_right">−0.08</td>
<td headers="model  95% Upper" class="gt_row gt_right">−0.01</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">geodist</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #7FBF7B; color: #000000;">0.58</td>
<td headers="model  p" class="gt_row gt_right">0.01</td>
<td headers="model  95% Lower" class="gt_row gt_right">0.54</td>
<td headers="model  95% Upper" class="gt_row gt_right">0.61</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">Intercept</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #F7F7F7; color: #000000;">0.00</td>
<td headers="model  p" class="gt_row gt_right">0.06</td>
<td headers="model  95% Lower" class="gt_row gt_right">−0.04</td>
<td headers="model  95% Upper" class="gt_row gt_right">0.04</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_empty_group_heading" scope="colgroup"></th>
    </tr>
<tr class="gt_row_group_first">
<td headers="NA  var" class="gt_row gt_left" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">R-Squared:</td>
<td headers="NA  estimate" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">0.35</td>
<td headers="NA  p" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Lower" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Upper" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
</tr>
<tr>
<td headers="NA  var" class="gt_row gt_left" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">F-Statistic:</td>
<td headers="NA  estimate" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">181.28</td>
<td headers="NA  p" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Lower" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Upper" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
</tr>
<tr>
<td headers="NA  var" class="gt_row gt_left" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">F p-value:</td>
<td headers="NA  estimate" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">0.01</td>
<td headers="NA  p" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Lower" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Upper" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level3">
<h3 id="running-mmrr-with-mmrr_do_everything">Running MMRR with <code>mmrr_do_everything()</code><a class="anchor" aria-label="anchor" href="#running-mmrr-with-mmrr_do_everything"></a>
</h3>
<hr>
<p>The algatr package also has an option to run all of the above
functionality in a single function, <code><a href="../reference/mmrr_do_everything.html">mmrr_do_everything()</a></code>.
This function runs MMRR while specifying whether a user would like to
run variable selection or not (using the <code>model</code> argument),
producing a table and all plots automatically. It will automatically
extract environmental variables based on coordinates and calculate
environmental distances from these data. Users can also choose to
include geographic distances within the independent variable matrix by
setting <code>geo = TRUE</code> (the default setting). <strong>Please be
aware that the <code>do_everything()</code> functions are meant to be
exploratory. We do not recommend their use for final analyses unless
certain they are properly parameterized.</strong></p>
<div class="section level4">
<h4 id="mmrr-with-all-variables-1">MMRR with all variables<a class="anchor" aria-label="anchor" href="#mmrr-with-all-variables-1"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">01</span><span class="op">)</span></span>
<span><span class="va">mmrr_full_everything</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrr_do_everything.html">mmrr_do_everything</a></span><span class="op">(</span><span class="va">liz_gendist</span>, <span class="va">liz_coords</span>, env <span class="op">=</span> <span class="va">CA_env</span>, geo <span class="op">=</span> <span class="cn">TRUE</span>, model <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></span></code></pre></div>
<img src="MMRR_vignette_files/figure-html/all%20vars-1.png" class="r-plt" width="480" style="display: block; margin: auto;"><img src="MMRR_vignette_files/figure-html/all%20vars-2.png" class="r-plt" width="480" style="display: block; margin: auto;"><img src="MMRR_vignette_files/figure-html/all%20vars-3.png" class="r-plt" width="480" style="display: block; margin: auto;"><div id="ccqjfuyawf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<p><style>#ccqjfuyawf table { font-family: system-ui, ‘Segoe UI’,
Roboto, Helvetica, Arial, sans-serif, ‘Apple Color Emoji’, ‘Segoe UI
Emoji’, ‘Segoe UI Symbol’, ‘Noto Color Emoji’; -webkit-font-smoothing:
antialiased; -moz-osx-font-smoothing: grayscale; }</p>
<p>#ccqjfuyawf thead, #ccqjfuyawf tbody, #ccqjfuyawf tfoot, #ccqjfuyawf
tr, #ccqjfuyawf td, #ccqjfuyawf th { border-style: none; }</p>
<p>#ccqjfuyawf p { margin: 0; padding: 0; }</p>
<p>#ccqjfuyawf .gt_table { display: table; border-collapse: collapse;
line-height: normal; margin-left: auto; margin-right: auto; color:
#333333; font-size: 16px; font-weight: normal; font-style: normal;
background-color: #FFFFFF; width: auto; border-top-style: solid;
border-top-width: 2px; border-top-color: #A8A8A8; border-right-style:
none; border-right-width: 2px; border-right-color: #D3D3D3;
border-bottom-style: solid; border-bottom-width: 2px;
border-bottom-color: #A8A8A8; border-left-style: none;
border-left-width: 2px; border-left-color: #D3D3D3; }</p>
<p>#ccqjfuyawf .gt_caption { padding-top: 4px; padding-bottom: 4px;
}</p>
<p>#ccqjfuyawf .gt_title { color: #333333; font-size: 125%; font-weight:
initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px;
padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width:
0; }</p>
<p>#ccqjfuyawf .gt_subtitle { color: #333333; font-size: 85%;
font-weight: initial; padding-top: 3px; padding-bottom: 5px;
padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF;
border-top-width: 0; }</p>
<p>#ccqjfuyawf .gt_heading { background-color: #FFFFFF; text-align:
center; border-bottom-color: #FFFFFF; border-left-style: none;
border-left-width: 1px; border-left-color: #D3D3D3; border-right-style:
none; border-right-width: 1px; border-right-color: #D3D3D3; }</p>
<p>#ccqjfuyawf .gt_bottom_border { border-bottom-style: solid;
border-bottom-width: 2px; border-bottom-color: #D3D3D3; }</p>
<p>#ccqjfuyawf .gt_col_headings { border-top-style: solid;
border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style:
solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3;
border-left-style: none; border-left-width: 1px; border-left-color:
#D3D3D3; border-right-style: none; border-right-width: 1px;
border-right-color: #D3D3D3; }</p>
<p>#ccqjfuyawf .gt_col_heading { color: #333333; background-color:
#FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit;
border-left-style: none; border-left-width: 1px; border-left-color:
#D3D3D3; border-right-style: none; border-right-width: 1px;
border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px;
padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x:
hidden; }</p>
<p>#ccqjfuyawf .gt_column_spanner_outer { color: #333333;
background-color: #FFFFFF; font-size: 100%; font-weight: normal;
text-transform: inherit; padding-top: 0; padding-bottom: 0;
padding-left: 4px; padding-right: 4px; }</p>
<p>#ccqjfuyawf .gt_column_spanner_outer:first-child { padding-left: 0;
}</p>
<p>#ccqjfuyawf .gt_column_spanner_outer:last-child { padding-right: 0;
}</p>
<p>#ccqjfuyawf .gt_column_spanner { border-bottom-style: solid;
border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align:
bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden;
display: inline-block; width: 100%; }</p>
<p>#ccqjfuyawf .gt_spanner_row { border-bottom-style: hidden; }</p>
<p>#ccqjfuyawf .gt_group_heading { padding-top: 8px; padding-bottom:
8px; padding-left: 5px; padding-right: 5px; color: #333333;
background-color: #FFFFFF; font-size: 100%; font-weight: initial;
text-transform: inherit; border-top-style: solid; border-top-width: 2px;
border-top-color: #D3D3D3; border-bottom-style: solid;
border-bottom-width: 2px; border-bottom-color: #D3D3D3;
border-left-style: none; border-left-width: 1px; border-left-color:
#D3D3D3; border-right-style: none; border-right-width: 1px;
border-right-color: #D3D3D3; vertical-align: middle; text-align: left;
}</p>
<p>#ccqjfuyawf .gt_empty_group_heading { padding: 0.5px; color: #333333;
background-color: #FFFFFF; font-size: 100%; font-weight: initial;
border-top-style: solid; border-top-width: 2px; border-top-color:
#D3D3D3; border-bottom-style: solid; border-bottom-width: 2px;
border-bottom-color: #D3D3D3; vertical-align: middle; }</p>
<p>#ccqjfuyawf .gt_from_md &gt; :first-child { margin-top: 0; }</p>
<p>#ccqjfuyawf .gt_from_md &gt; :last-child { margin-bottom: 0; }</p>
<p>#ccqjfuyawf .gt_row { padding-top: 8px; padding-bottom: 8px;
padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style:
solid; border-top-width: 1px; border-top-color: #D3D3D3;
border-left-style: none; border-left-width: 1px; border-left-color:
#D3D3D3; border-right-style: none; border-right-width: 1px;
border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden;
}</p>
<p>#ccqjfuyawf .gt_stub { color: #333333; background-color: #FFFFFF;
font-size: 100%; font-weight: initial; text-transform: inherit;
border-right-style: solid; border-right-width: 2px; border-right-color:
#D3D3D3; padding-left: 5px; padding-right: 5px; }</p>
<p>#ccqjfuyawf .gt_stub_row_group { color: #333333; background-color:
#FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit;
border-right-style: solid; border-right-width: 2px; border-right-color:
#D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top;
}</p>
<p>#ccqjfuyawf .gt_row_group_first td { border-top-width: 2px; }</p>
<p>#ccqjfuyawf .gt_row_group_first th { border-top-width: 2px; }</p>
<p>#ccqjfuyawf .gt_summary_row { color: #333333; background-color:
#FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px;
padding-left: 5px; padding-right: 5px; }</p>
<p>#ccqjfuyawf .gt_first_summary_row { border-top-style: solid;
border-top-color: #D3D3D3; }</p>
<p>#ccqjfuyawf .gt_first_summary_row.thick { border-top-width: 2px;
}</p>
<p>#ccqjfuyawf .gt_last_summary_row { padding-top: 8px; padding-bottom:
8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid;
border-bottom-width: 2px; border-bottom-color: #D3D3D3; }</p>
<p>#ccqjfuyawf .gt_grand_summary_row { color: #333333; background-color:
#FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px;
padding-left: 5px; padding-right: 5px; }</p>
<p>#ccqjfuyawf .gt_first_grand_summary_row { padding-top: 8px;
padding-bottom: 8px; padding-left: 5px; padding-right: 5px;
border-top-style: double; border-top-width: 6px; border-top-color:
#D3D3D3; }</p>
<p>#ccqjfuyawf .gt_last_grand_summary_row_top { padding-top: 8px;
padding-bottom: 8px; padding-left: 5px; padding-right: 5px;
border-bottom-style: double; border-bottom-width: 6px;
border-bottom-color: #D3D3D3; }</p>
<p>#ccqjfuyawf .gt_striped { background-color: rgba(128, 128, 128,
0.05); }</p>
<p>#ccqjfuyawf .gt_table_body { border-top-style: solid;
border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style:
solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; }</p>
<p>#ccqjfuyawf .gt_footnotes { color: #333333; background-color:
#FFFFFF; border-bottom-style: none; border-bottom-width: 2px;
border-bottom-color: #D3D3D3; border-left-style: none;
border-left-width: 2px; border-left-color: #D3D3D3; border-right-style:
none; border-right-width: 2px; border-right-color: #D3D3D3; }</p>
<p>#ccqjfuyawf .gt_footnote { margin: 0px; font-size: 90%; padding-top:
4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; }</p>
<p>#ccqjfuyawf .gt_sourcenotes { color: #333333; background-color:
#FFFFFF; border-bottom-style: none; border-bottom-width: 2px;
border-bottom-color: #D3D3D3; border-left-style: none;
border-left-width: 2px; border-left-color: #D3D3D3; border-right-style:
none; border-right-width: 2px; border-right-color: #D3D3D3; }</p>
<p>#ccqjfuyawf .gt_sourcenote { font-size: 90%; padding-top: 4px;
padding-bottom: 4px; padding-left: 5px; padding-right: 5px; }</p>
<p>#ccqjfuyawf .gt_left { text-align: left; }</p>
<p>#ccqjfuyawf .gt_center { text-align: center; }</p>
<p>#ccqjfuyawf .gt_right { text-align: right; font-variant-numeric:
tabular-nums; }</p>
<p>#ccqjfuyawf .gt_font_normal { font-weight: normal; }</p>
<p>#ccqjfuyawf .gt_font_bold { font-weight: bold; }</p>
<p>#ccqjfuyawf .gt_font_italic { font-style: italic; }</p>
<p>#ccqjfuyawf .gt_super { font-size: 65%; }</p>
<p>#ccqjfuyawf .gt_footnote_marks { font-size: 75%; vertical-align:
0.4em; position: initial; }</p>
<p>#ccqjfuyawf .gt_asterisk { font-size: 100%; vertical-align: 0; }</p>
<p>#ccqjfuyawf .gt_indent_1 { text-indent: 5px; }</p>
<p>#ccqjfuyawf .gt_indent_2 { text-indent: 10px; }</p>
<p>#ccqjfuyawf .gt_indent_3 { text-indent: 15px; }</p>
<p>#ccqjfuyawf .gt_indent_4 { text-indent: 20px; }</p>
<p>#ccqjfuyawf .gt_indent_5 { text-indent: 25px; }</p>
<p>#ccqjfuyawf .katex-display { display: inline-flex !important;
margin-bottom: 0.75em !important; }</p>
#ccqjfuyawf div.Reactable &gt; div.rt-table &gt; div.rt-thead &gt;
div.rt-tr.rt-tr-group-header &gt; div.rt-th-group:after { height: 0px
!important; } </style></p>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="var">
var
</th>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">
estimate
</th>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p">
p
</th>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a95%-Lower">
95% Lower
</th>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a95%-Upper">
95% Upper
</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_empty_group_heading" scope="colgroup">
</th>
</tr>
<tr class="gt_row_group_first">
<td headers="model  var" class="gt_row gt_left">
CA_rPCA1
</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #F2EBF2; color: #000000;">
−0.10
</td>
<td headers="model  p" class="gt_row gt_right">
0.05
</td>
<td headers="model  95% Lower" class="gt_row gt_right">
−0.14
</td>
<td headers="model  95% Upper" class="gt_row gt_right">
−0.07
</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">
CA_rPCA2
</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #F6F7F6; color: #000000;">
0.01
</td>
<td headers="model  p" class="gt_row gt_right">
0.78
</td>
<td headers="model  95% Lower" class="gt_row gt_right">
−0.03
</td>
<td headers="model  95% Upper" class="gt_row gt_right">
0.05
</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">
CA_rPCA3
</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #F4F1F4; color: #000000;">
−0.05
</td>
<td headers="model  p" class="gt_row gt_right">
0.36
</td>
<td headers="model  95% Lower" class="gt_row gt_right">
−0.08
</td>
<td headers="model  95% Upper" class="gt_row gt_right">
−0.01
</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">
geodist
</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #7FBF7B; color: #000000;">
0.58
</td>
<td headers="model  p" class="gt_row gt_right">
0.00
</td>
<td headers="model  95% Lower" class="gt_row gt_right">
0.54
</td>
<td headers="model  95% Upper" class="gt_row gt_right">
0.61
</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">
Intercept
</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #F7F7F7; color: #000000;">
0.00
</td>
<td headers="model  p" class="gt_row gt_right">
0.06
</td>
<td headers="model  95% Lower" class="gt_row gt_right">
−0.04
</td>
<td headers="model  95% Upper" class="gt_row gt_right">
0.04
</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_empty_group_heading" scope="colgroup">
</th>
</tr>
<tr class="gt_row_group_first">
<td headers="NA  var" class="gt_row gt_left" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
R-Squared:
</td>
<td headers="NA  estimate" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
0.35
</td>
<td headers="NA  p" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
<br>
</td>
<td headers="NA  95% Lower" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
<br>
</td>
<td headers="NA  95% Upper" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
<br>
</td>
</tr>
<tr>
<td headers="NA  var" class="gt_row gt_left" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
F-Statistic:
</td>
<td headers="NA  estimate" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
181.28
</td>
<td headers="NA  p" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
<br>
</td>
<td headers="NA  95% Lower" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
<br>
</td>
<td headers="NA  95% Upper" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
<br>
</td>
</tr>
<tr>
<td headers="NA  var" class="gt_row gt_left" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
F p-value:
</td>
<td headers="NA  estimate" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
0.00
</td>
<td headers="NA  p" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
<br>
</td>
<td headers="NA  95% Lower" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
<br>
</td>
<td headers="NA  95% Upper" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">
<br>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level4">
<h4 id="extending-mmrrs-functionality-with-resistance-distances">Extending MMRR’s functionality with resistance distances<a class="anchor" aria-label="anchor" href="#extending-mmrrs-functionality-with-resistance-distances"></a>
</h4>
<p>The relationships between geographic distance and/or environmental
variables on spatial genetic variation result in patterns of isolation
by distance (IBD) or isolation by environment (IBE), respectively.
However, one other key phenomenon that can occur - and one in which
landscape genomicists are often interested in examining - is one in
which landscape features act to restrict gene flow, resulting in a
pattern known as isolation by resistance (IBR). IBR is typically
investigated by first generating a resistance surface which provides
information about how the landscape “resists” gene flow given the study
organism. Then, given the resistance surface, resistance distances can
be calculated using (once again) a variety of methods, but most
typically use <a href="https://conbio.onlinelibrary.wiley.com/doi/abs/10.1111/cobi.13230" class="external-link">circuit
theory</a> to model connectivity across the landscape.</p>
<p>The resistance surface can be generated using species distribution
models, habitat suitability models, or other types of approaches that
simulate forward evolution given sampling localities and genotypes
(e.g., resistanceGA; <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/2041-210X.12984" class="external-link">Peterman
2018</a>). Building a reliable resistance surface can be quite complex,
requiring many decisions on the part of the researcher and, in some
cases, extensive parameterization and model testing to generate this
type of surface. These sets of decisions are precisely why algatr does
not explicitly implement any IBR methods, but below we describe one way
in which the package can be extended to do so.</p>
<p>As was briefly mentioned in the environmental data vignette, the
<code><a href="../reference/geo_dist.html">geo_dist()</a></code> function is able to calculate resistance-based
distances, largely using the <a href="https://cran.r-project.org/web/packages/gdistance/index.html" class="external-link">gdistance</a>
package (<a href="https://www.jstatsoft.org/article/view/v076i13" class="external-link">van
Etten 2017</a>). Importantly, a user must provide a resistance surface
using whichever their preferred method is by specifying the
<code>lyr</code> argument. The function then creates a transition
surface and calculates circuit distances (random-walk commute distances)
using the <code><a href="https://AgrDataSci.github.io/gdistance/reference/commuteDistance-methods.html" class="external-link">gdistance::commuteDistance()</a></code> function.</p>
<p>Although algatr does not have the explicit functionality to quantify
and visualize IBR, we can investigate IBR using MMRR given that this
method conducts a multiple Mantel test given some distance metric. Thus,
it is possible to run <code><a href="../reference/geo_dist.html">geo_dist()</a></code> specifying
<code>lyr</code> with your resistance raster and use the resulting
distances as input into MMRR. The following is a <em>toy</em> example of
how this could be done. For this example we’ll pretend our resistance
surface is one of our environmental layers (where greater values
indicate more resistance) and use it to calculate our resistance
distances.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># here we aggregate the layer for computational speed</span></span>
<span><span class="va">lyr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">CA_env</span><span class="op">$</span><span class="va">CA_rPCA1</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lyr</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="va">liz_coords</span><span class="op">)</span></span></code></pre></div>
<p><img src="MMRR_vignette_files/figure-html/toy%20resist%20surface-1.png" class="r-plt" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Recreate MMRR input with resistance distances</span></span>
<span><span class="co"># Calculate environmental distances</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/env_dist.html">env_dist</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span></span>
<span><span class="co"># Add geographic distance to X</span></span>
<span><span class="va">X</span><span class="op">[[</span><span class="st">"resistdist"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geo_dist.html">geo_dist</a></span><span class="op">(</span><span class="va">liz_coords</span>, type <span class="op">=</span> <span class="st">"resistance"</span>, lyr <span class="op">=</span> <span class="va">lyr</span><span class="op">)</span></span>
<span><span class="co">#&gt; Calculating resistance distances... This can be time consuming with many points and large rasters.</span></span></code></pre></div>
<p>Now, we can run MMRR as we did above but including resistance-based
distances in our input data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run MMRR with resistance distances</span></span>
<span><span class="va">results_resist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mmrr_run.html">mmrr_run</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, nperm <span class="op">=</span> <span class="fl">99</span>, stdz <span class="op">=</span> <span class="cn">TRUE</span>, model <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/mmrr_plot.html">mmrr_plot</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, mod <span class="op">=</span> <span class="va">results_resist</span><span class="op">$</span><span class="va">mod</span>, plot_type <span class="op">=</span> <span class="st">"all"</span>, stdz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="MMRR_vignette_files/figure-html/mmrr%20resist-1.png" class="r-plt" width="480" style="display: block; margin: auto;"><img src="MMRR_vignette_files/figure-html/mmrr%20resist-2.png" class="r-plt" width="480" style="display: block; margin: auto;"><img src="MMRR_vignette_files/figure-html/mmrr%20resist-3.png" class="r-plt" width="480" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mmrr_table.html">mmrr_table</a></span><span class="op">(</span><span class="va">results_resist</span><span class="op">)</span></span></code></pre></div>
<div id="mbhanvqnxp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mbhanvqnxp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mbhanvqnxp thead, #mbhanvqnxp tbody, #mbhanvqnxp tfoot, #mbhanvqnxp tr, #mbhanvqnxp td, #mbhanvqnxp th {
  border-style: none;
}

#mbhanvqnxp p {
  margin: 0;
  padding: 0;
}

#mbhanvqnxp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mbhanvqnxp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mbhanvqnxp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mbhanvqnxp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mbhanvqnxp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mbhanvqnxp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mbhanvqnxp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mbhanvqnxp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mbhanvqnxp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mbhanvqnxp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mbhanvqnxp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mbhanvqnxp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mbhanvqnxp .gt_spanner_row {
  border-bottom-style: hidden;
}

#mbhanvqnxp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mbhanvqnxp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mbhanvqnxp .gt_from_md > :first-child {
  margin-top: 0;
}

#mbhanvqnxp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mbhanvqnxp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mbhanvqnxp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mbhanvqnxp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mbhanvqnxp .gt_row_group_first td {
  border-top-width: 2px;
}

#mbhanvqnxp .gt_row_group_first th {
  border-top-width: 2px;
}

#mbhanvqnxp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbhanvqnxp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mbhanvqnxp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mbhanvqnxp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mbhanvqnxp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbhanvqnxp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mbhanvqnxp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mbhanvqnxp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mbhanvqnxp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mbhanvqnxp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mbhanvqnxp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbhanvqnxp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mbhanvqnxp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mbhanvqnxp .gt_left {
  text-align: left;
}

#mbhanvqnxp .gt_center {
  text-align: center;
}

#mbhanvqnxp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mbhanvqnxp .gt_font_normal {
  font-weight: normal;
}

#mbhanvqnxp .gt_font_bold {
  font-weight: bold;
}

#mbhanvqnxp .gt_font_italic {
  font-style: italic;
}

#mbhanvqnxp .gt_super {
  font-size: 65%;
}

#mbhanvqnxp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mbhanvqnxp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mbhanvqnxp .gt_indent_1 {
  text-indent: 5px;
}

#mbhanvqnxp .gt_indent_2 {
  text-indent: 10px;
}

#mbhanvqnxp .gt_indent_3 {
  text-indent: 15px;
}

#mbhanvqnxp .gt_indent_4 {
  text-indent: 20px;
}

#mbhanvqnxp .gt_indent_5 {
  text-indent: 25px;
}

#mbhanvqnxp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mbhanvqnxp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="var">var</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p">p</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a95%-Lower">95% Lower</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="a95%-Upper">95% Upper</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_empty_group_heading" scope="colgroup"></th>
    </tr>
<tr class="gt_row_group_first">
<td headers="model  var" class="gt_row gt_left">CA_rPCA1</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #F4F1F4; color: #000000;">−0.05</td>
<td headers="model  p" class="gt_row gt_right">0.39</td>
<td headers="model  95% Lower" class="gt_row gt_right">−0.12</td>
<td headers="model  95% Upper" class="gt_row gt_right">0.02</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">CA_rPCA2</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #E2F2DD; color: #000000;">0.20</td>
<td headers="model  p" class="gt_row gt_right">0.01</td>
<td headers="model  95% Lower" class="gt_row gt_right">0.12</td>
<td headers="model  95% Upper" class="gt_row gt_right">0.28</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">CA_rPCA3</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #EAF4E8; color: #000000;">0.12</td>
<td headers="model  p" class="gt_row gt_right">0.15</td>
<td headers="model  95% Lower" class="gt_row gt_right">0.05</td>
<td headers="model  95% Upper" class="gt_row gt_right">0.20</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">Intercept</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #EDF5EB; color: #000000;">0.09</td>
<td headers="model  p" class="gt_row gt_right">0.24</td>
<td headers="model  95% Lower" class="gt_row gt_right">0.02</td>
<td headers="model  95% Upper" class="gt_row gt_right">0.15</td>
</tr>
<tr>
<td headers="model  var" class="gt_row gt_left">resistdist</td>
<td headers="model  estimate" class="gt_row gt_right" style="background-color: #7FBF7B; color: #000000;">0.56</td>
<td headers="model  p" class="gt_row gt_right">0.01</td>
<td headers="model  95% Lower" class="gt_row gt_right">0.50</td>
<td headers="model  95% Upper" class="gt_row gt_right">0.62</td>
</tr>
<tr class="gt_group_heading_row">
<th colspan="5" class="gt_empty_group_heading" scope="colgroup"></th>
    </tr>
<tr class="gt_row_group_first">
<td headers="NA  var" class="gt_row gt_left" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">R-Squared:</td>
<td headers="NA  estimate" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">0.40</td>
<td headers="NA  p" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Lower" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Upper" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
</tr>
<tr>
<td headers="NA  var" class="gt_row gt_left" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">F-Statistic:</td>
<td headers="NA  estimate" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">76.62</td>
<td headers="NA  p" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Lower" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Upper" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
</tr>
<tr>
<td headers="NA  var" class="gt_row gt_left" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">F p-value:</td>
<td headers="NA  estimate" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;">0.01</td>
<td headers="NA  p" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Lower" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
<td headers="NA  95% Upper" class="gt_row gt_right" style="background-color: rgba(255,255,255,0.8); color: #000000; font-weight: bold; text-align: left; border-top-width: 1px; border-top-style: solid; border-top-color: white; padding-top:2px;padding-bottom:2px;"><br></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level3">
<h3 id="additional-documentation-and-citations">Additional documentation and citations<a class="anchor" aria-label="anchor" href="#additional-documentation-and-citations"></a>
</h3>
<hr>
<table class="table">
<colgroup>
<col width="23%">
<col width="41%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Citation/URL</th>
<th>Details</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Manuscript with method</td>
<td><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/evo.12134" class="external-link">Wang
2013</a></td>
<td>Paper describing MMRR method</td>
</tr>
<tr class="even">
<td>Associated code</td>
<td><a href="https://nature.berkeley.edu/wanglab/wp-content/uploads/2019/09/MMRRtutorial.zip" class="external-link">MMRR
tutorial</a></td>
<td>Walkthrough of MMRR</td>
</tr>
</tbody>
</table>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anusha Bishop, Anne Chambers, Ian Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
